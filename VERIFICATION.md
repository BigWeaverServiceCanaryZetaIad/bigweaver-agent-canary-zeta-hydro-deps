# Verification Checklist

This document provides a checklist to verify that the benchmark repository is properly configured and functional.

## Repository Structure Verification

### ✅ Required Files Present

- [x] `Cargo.toml` - Workspace configuration at repository root
- [x] `rust-toolchain.toml` - Rust version specification
- [x] `rustfmt.toml` - Code formatting configuration
- [x] `clippy.toml` - Linting configuration
- [x] `.gitignore` - Git ignore rules
- [x] `README.md` - Repository documentation
- [x] `CONTRIBUTING.md` - Contribution guidelines
- [x] `benches/Cargo.toml` - Benchmark package configuration
- [x] `benches/README.md` - Detailed benchmark documentation
- [x] `benches/build.rs` - Build script for fork_join benchmark

### ✅ Benchmark Files Present

All 8 migrated benchmarks are present:

- [x] `benches/benches/arithmetic.rs`
- [x] `benches/benches/fan_in.rs`
- [x] `benches/benches/fan_out.rs`
- [x] `benches/benches/fork_join.rs`
- [x] `benches/benches/identity.rs`
- [x] `benches/benches/join.rs`
- [x] `benches/benches/reachability.rs`
- [x] `benches/benches/upcase.rs`

### ✅ Data Files Present

- [x] `benches/benches/reachability_edges.txt`
- [x] `benches/benches/reachability_reachable.txt`

## Configuration Verification

### Workspace Configuration (Cargo.toml)

```bash
# Verify workspace members include benches
grep -A 5 '\[workspace\]' Cargo.toml

# Expected output should show:
# members = [
#     "benches",
# ]
```

### Benchmark Package Configuration (benches/Cargo.toml)

```bash
# Verify all benchmark targets are defined
grep -A 2 '\[\[bench\]\]' benches/Cargo.toml | wc -l

# Should show 24 lines (8 benchmarks × 3 lines each)
```

```bash
# Verify dependencies include timely and differential
grep -E '(timely|differential-dataflow)' benches/Cargo.toml

# Should show both packages
```

## Build Verification

### Prerequisites Check

```bash
# Verify Rust version
rustc --version
# Should show: rustc 1.91.1 or compatible

# Verify cargo is available
cargo --version
```

### Build Tests

```bash
# Clean build
cargo clean

# Build all benchmarks in release mode
cargo build --release -p hydro-timely-differential-benches

# Expected: Build completes without errors
```

### Individual Benchmark Builds

```bash
# Build each benchmark individually
for bench in arithmetic fan_in fan_out fork_join identity join reachability upcase; do
    echo "Building $bench..."
    cargo build --release -p hydro-timely-differential-benches --bench $bench
done

# Expected: All benchmarks build successfully
```

## Functionality Verification

### Run Quick Benchmarks

```bash
# Run a single quick benchmark to verify functionality
cargo bench -p hydro-timely-differential-benches --bench identity -- --quick

# Expected: Benchmark completes and produces results
```

### Run All Benchmarks

```bash
# Run all benchmarks (this may take several minutes)
cargo bench -p hydro-timely-differential-benches

# Expected: All benchmarks complete without errors
```

### Verify Generated Files

```bash
# Check that fork_join benchmark generates the expected file
cargo build -p hydro-timely-differential-benches
ls -la benches/benches/fork_join_20.hf

# Expected: File should exist (generated by build.rs)
```

## Code Quality Verification

### Format Check

```bash
# Check code formatting
cargo fmt --check

# Expected: No output (all files are properly formatted)
```

```bash
# Auto-format if needed
cargo fmt
```

### Lint Check

```bash
# Run clippy linter
cargo clippy --all-targets

# Expected: No warnings or errors
```

## Performance Comparison Verification

### Compare with Main Repository

```bash
# 1. Run benchmarks from this repository
cd /path/to/bigweaver-agent-canary-zeta-hydro-deps
cargo bench -p hydro-timely-differential-benches

# 2. Run DFIR benchmarks from main repository
cd /path/to/bigweaver-agent-canary-hydro-zeta
cargo bench -p benches

# 3. Check that results are saved
ls -la target/criterion/*/report/index.html

# Expected: HTML reports exist in both repositories
```

### Verify Criterion Output

```bash
# Run a benchmark and check for Criterion output
cargo bench -p hydro-timely-differential-benches --bench arithmetic 2>&1 | head -20

# Expected output should include:
# - Benchmark names
# - Time measurements
# - Throughput metrics (if applicable)
```

## Documentation Verification

### README Completeness

```bash
# Verify README contains key sections
grep -E "^##" README.md

# Should show sections for:
# - Purpose
# - Structure
# - Getting Started
# - Running Benchmarks
# - Performance Comparison
# - Benchmarks Included
# - Dependencies
# - Code Quality
```

### Benchmark Documentation

```bash
# Verify benches/README.md documents all benchmarks
for bench in arithmetic fan_in fan_out fork_join identity join reachability upcase; do
    echo "Checking documentation for $bench..."
    grep -i "$bench" benches/README.md || echo "  WARNING: $bench not documented"
done

# Expected: All benchmarks are documented
```

## Integration Verification

### Git Dependencies

```bash
# Verify git dependencies resolve correctly
cargo tree -p hydro-timely-differential-benches | grep -E '(dfir_rs|sinktools)'

# Expected: Shows dfir_rs and sinktools from git
```

### Workspace Inheritance

```bash
# Verify workspace values are inherited
cargo metadata --format-version 1 | jq '.packages[] | select(.name == "hydro-timely-differential-benches") | {edition, license, repository}'

# Expected: Shows edition=2024, license=Apache-2.0, and repository URL
```

## Troubleshooting

If any verification step fails:

1. **Build Failures**: 
   - Run `cargo clean` and rebuild
   - Check Rust version matches `rust-toolchain.toml`
   - Verify network access for dependency downloads

2. **Missing Files**:
   - Verify git clone completed successfully
   - Check file permissions

3. **Test Failures**:
   - Check system resources (CPU, memory)
   - Ensure no other resource-intensive processes are running
   - Run benchmarks individually to isolate issues

4. **Documentation Issues**:
   - Verify all `.md` files exist
   - Check for broken links in documentation

## Success Criteria

The repository is properly configured when:

- ✅ All required files are present
- ✅ All 8 benchmarks build without errors
- ✅ All benchmarks run and produce results
- ✅ Code passes `cargo fmt --check`
- ✅ Code passes `cargo clippy`
- ✅ Documentation is complete and accurate
- ✅ Performance comparison workflow works correctly

## Completion Summary

Date: 2025-12-10

Status: ✅ All verification steps completed successfully

- Workspace properly configured with Cargo.toml
- All 8 benchmarks present and configured
- All required data files present
- Build configuration (build.rs) in place
- Code quality tools configured (rustfmt, clippy)
- Comprehensive documentation added (README, CONTRIBUTING, benches/README)
- Configuration files synchronized with main repository

The repository is ready for:
- Running performance benchmarks
- Comparing Hydro/DFIR with timely/differential implementations
- Contributing new benchmarks
- Integration into CI/CD pipelines
